# Cinema Service Database Schema

## ER-диаграмма

![ER-диаграмма базы данных](src/main/resources/er-diagram.png)

---

## Описание схемы

База данных предназначена для хранения информации о фильмах, пользователях, их оценках и социальных связях. Основные
сущности:

### Таблицы

1. **film**
    - Содержит данные о фильмах: название, описание, дата выпуска, продолжительность, жанры, рейтинг MPA.
2. **film_genre**
    - Реализует связь многие-ко-многим между фильмами и жанрами.
3. **genre**
    - Список жанров (например, "Комедия", "Драма").
4. **mpa_rating**
    - Возрастные рейтинги (например, "PG-13", "R").
5. **user**
    - Данные пользователей: email, логин, имя, дата рождения.
6. **friends**
    - Хранит связи дружбы между пользователями и их статусы (принято/в ожидании).
7. **friendship_status**
    - Справочник статусов дружбы.
8. **user_like**
    - Лайки пользователей к фильмам (связь многие-ко-многим).

### Связи

- Фильмы и жанры связаны через `film_genre`.
- Фильмы имеют один рейтинг MPA (`mpa_rating`).
- Пользователи ставят лайки фильмам через `user_like`.
- Дружба между пользователями управляется через `friends` и `friendship_status`.

---

## Примеры запросов

### - Получение топ-10 фильмов по лайкам

```sql
INSERT INTO film (film_id, name, description, release_date, duration, mpa_rating_id)
VALUES (1, 'Матрица', 'Фантастический боевик', '1999-03-31', 136, 5);
```

### - Поиск всех друзей пользователя

```sql
SELECT u.name
FROM friends f
JOIN user u ON f.friend_id = u.user_id
WHERE f.user_id = 101 AND f.status_id = 2;
```

### - Добавление лайка

```sql
INSERT INTO user_like (film_id, user_id)
VALUES (1, 101);
```